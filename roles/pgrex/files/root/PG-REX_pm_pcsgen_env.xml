<cib crm_feature_set="3.7.1" validate-with="pacemaker-3.6" epoch="27" num_updates="0" admin_epoch="0">
  <configuration>
    <crm_config>
      <cluster_property_set id="cib-bootstrap-options">
        <nvpair id="cib-bootstrap-options-priority-fencing-delay" name="priority-fencing-delay" value="10s"/>
      </cluster_property_set>
    </crm_config>
    <nodes/>
    <resources>
      <group id="primary-group">
        <primitive class="ocf" id="ipaddr-primary" provider="heartbeat" type="IPaddr2">
          <instance_attributes id="ipaddr-primary-instance_attributes">
            <nvpair id="ipaddr-primary-instance_attributes-cidr_netmask" name="cidr_netmask" value="24"/>
            <nvpair id="ipaddr-primary-instance_attributes-ip" name="ip" value="192.168.1.11"/>
            <nvpair id="ipaddr-primary-instance_attributes-nic" name="nic" value="eth1"/>
          </instance_attributes>
          <operations>
            <op id="ipaddr-primary-monitor-interval-10s" interval="10s" name="monitor" on-fail="restart" timeout="60s"/>
            <op id="ipaddr-primary-start-interval-0s" interval="0s" name="start" on-fail="restart" timeout="60s"/>
            <op id="ipaddr-primary-stop-interval-0s" interval="0s" name="stop" on-fail="fence" timeout="60s"/>
          </operations>
        </primitive>
        <primitive class="ocf" id="ipaddr-replication" provider="heartbeat" type="IPaddr2">
          <instance_attributes id="ipaddr-replication-instance_attributes">
            <nvpair id="ipaddr-replication-instance_attributes-cidr_netmask" name="cidr_netmask" value="24"/>
            <nvpair id="ipaddr-replication-instance_attributes-ip" name="ip" value="192.168.2.30"/>
            <nvpair id="ipaddr-replication-instance_attributes-nic" name="nic" value="eth2"/>
          </instance_attributes>
          <meta_attributes id="ipaddr-replication-meta_attributes">
            <nvpair id="ipaddr-replication-meta_attributes-migration-threshold" name="migration-threshold" value="0"/>
          </meta_attributes>
          <operations>
            <op id="ipaddr-replication-monitor-interval-10s" interval="10s" name="monitor" on-fail="restart" timeout="60s"/>
            <op id="ipaddr-replication-start-interval-0s" interval="0s" name="start" on-fail="stop" timeout="60s"/>
            <op id="ipaddr-replication-stop-interval-0s" interval="0s" name="stop" on-fail="ignore" timeout="60s"/>
          </operations>
        </primitive>
      </group>
      <primitive class="ocf" id="ipaddr-standby" provider="heartbeat" type="IPaddr2">
        <instance_attributes id="ipaddr-standby-instance_attributes">
          <nvpair id="ipaddr-standby-instance_attributes-cidr_netmask" name="cidr_netmask" value="24"/>
          <nvpair id="ipaddr-standby-instance_attributes-ip" name="ip" value="192.168.1.21"/>
          <nvpair id="ipaddr-standby-instance_attributes-nic" name="nic" value="eth1"/>
        </instance_attributes>
        <meta_attributes id="ipaddr-standby-meta_attributes">
          <nvpair id="ipaddr-standby-meta_attributes-resource-stickiness" name="resource-stickiness" value="1"/>
        </meta_attributes>
        <operations>
          <op id="ipaddr-standby-monitor-interval-10s" interval="10s" name="monitor" on-fail="restart" timeout="60s"/>
          <op id="ipaddr-standby-start-interval-0s" interval="0s" name="start" on-fail="restart" timeout="60s"/>
          <op id="ipaddr-standby-stop-interval-0s" interval="0s" name="stop" on-fail="fence" timeout="60s"/>
        </operations>
      </primitive>
      <clone id="pgsql-clone">
        <primitive class="ocf" id="pgsql" provider="linuxhajp" type="pgsql">
          <instance_attributes id="pgsql-instance_attributes">
            <nvpair id="pgsql-instance_attributes-master_ip" name="master_ip" value="192.168.2.30"/>
            <nvpair id="pgsql-instance_attributes-node_list" name="node_list" value="pgrex01 pgrex02"/>
            <nvpair id="pgsql-instance_attributes-pgctl" name="pgctl" value="/usr/pgsql-13/bin/pg_ctl"/>
            <nvpair id="pgsql-instance_attributes-pgdata" name="pgdata" value="/dbfp/pgdata/data"/>
            <nvpair id="pgsql-instance_attributes-pgdb" name="pgdb" value="template1"/>
            <nvpair id="pgsql-instance_attributes-pgdba" name="pgdba" value="postgres"/>
            <nvpair id="pgsql-instance_attributes-pgport" name="pgport" value="5432"/>
            <nvpair id="pgsql-instance_attributes-primary_conninfo_opt" name="primary_conninfo_opt" value="keepalives_idle=60 keepalives_interval=5 keepalives_count=5"/>
            <nvpair id="pgsql-instance_attributes-psql" name="psql" value="/usr/pgsql-13/bin/psql"/>
            <nvpair id="pgsql-instance_attributes-rep_mode" name="rep_mode" value="sync"/>
            <nvpair id="pgsql-instance_attributes-repuser" name="repuser" value="repuser"/>
            <nvpair id="pgsql-instance_attributes-restore_command" name="restore_command" value="/bin/cp /dbfp/pgarch/arc1/%f %p"/>
            <nvpair id="pgsql-instance_attributes-stop_escalate" name="stop_escalate" value="0"/>
            <nvpair id="pgsql-instance_attributes-xlog_check_count" name="xlog_check_count" value="0"/>
          </instance_attributes>
          <operations>
            <op id="pgsql-demote-interval-0s" interval="0s" name="demote" on-fail="fence" timeout="300s"/>
            <op id="pgsql-methods-interval-0s" interval="0s" name="methods" timeout="5s"/>
            <op id="pgsql-monitor-interval-10s" interval="10s" name="monitor" on-fail="restart" timeout="60s"/>
            <op id="pgsql-monitor-interval-9s" interval="9s" name="monitor" on-fail="restart" role="Master" timeout="60s"/>
            <op id="pgsql-notify-interval-0s" interval="0s" name="notify" timeout="60s"/>
            <op id="pgsql-promote-interval-0s" interval="0s" name="promote" on-fail="restart" timeout="300s"/>
            <op id="pgsql-start-interval-0s" interval="0s" name="start" on-fail="restart" timeout="300s"/>
            <op id="pgsql-stop-interval-0s" interval="0s" name="stop" on-fail="fence" timeout="300s"/>
          </operations>
        </primitive>
        <meta_attributes id="pgsql-clone-meta_attributes">
          <nvpair id="pgsql-clone-meta_attributes-promotable" name="promotable" value="true"/>
          <nvpair id="pgsql-clone-meta_attributes-promoted-max" name="promoted-max" value="1"/>
          <nvpair id="pgsql-clone-meta_attributes-promoted-node-max" name="promoted-node-max" value="1"/>
          <nvpair id="pgsql-clone-meta_attributes-clone-max" name="clone-max" value="2"/>
          <nvpair id="pgsql-clone-meta_attributes-clone-node-max" name="clone-node-max" value="1"/>
          <nvpair id="pgsql-clone-meta_attributes-notify" name="notify" value="true"/>
          <nvpair id="pgsql-clone-meta_attributes-priority" name="priority" value="1"/>
        </meta_attributes>
      </clone>
      <clone id="ping-clone">
        <primitive class="ocf" id="ping" provider="pacemaker" type="ping">
          <instance_attributes id="ping-instance_attributes">
            <nvpair id="ping-instance_attributes-attempts" name="attempts" value="2"/>
            <nvpair id="ping-instance_attributes-debug" name="debug" value="true"/>
            <nvpair id="ping-instance_attributes-host_list" name="host_list" value="192.168.1.1"/>
            <nvpair id="ping-instance_attributes-name" name="name" value="ping-status"/>
            <nvpair id="ping-instance_attributes-timeout" name="timeout" value="2"/>
          </instance_attributes>
          <operations>
            <op id="ping-monitor-interval-10s" interval="10s" name="monitor" on-fail="restart" timeout="60s"/>
            <op id="ping-start-interval-0s" interval="0s" name="start" on-fail="restart" timeout="60s"/>
            <op id="ping-stop-interval-0s" interval="0s" name="stop" on-fail="fence" timeout="60s"/>
          </operations>
        </primitive>
      </clone>
      <primitive class="stonith" id="fence1-ipmilan" type="fence_ipmilan">
        <instance_attributes id="fence1-ipmilan-instance_attributes">
          <nvpair id="fence1-ipmilan-instance_attributes-ip" name="ip" value="172.20.145.87"/>
          <nvpair id="fence1-ipmilan-instance_attributes-lanplus" name="lanplus" value="1"/>
          <nvpair id="fence1-ipmilan-instance_attributes-password" name="password" value="MKTZ9FFG"/>
          <nvpair id="fence1-ipmilan-instance_attributes-pcmk_host_list" name="pcmk_host_list" value="pg-rex41"/>
          <nvpair id="fence1-ipmilan-instance_attributes-username" name="username" value="Administrator"/>
        </instance_attributes>
        <operations>
          <op id="fence1-ipmilan-monitor-interval-3600s" interval="3600s" name="monitor" on-fail="restart" timeout="60s"/>
          <op id="fence1-ipmilan-start-interval-0s" interval="0s" name="start" on-fail="restart" timeout="60s"/>
          <op id="fence1-ipmilan-stop-interval-0s" interval="0s" name="stop" on-fail="ignore" timeout="60s"/>
        </operations>
      </primitive>
      <primitive class="stonith" id="fence2-ipmilan" type="fence_ipmilan">
        <instance_attributes id="fence2-ipmilan-instance_attributes">
          <nvpair id="fence2-ipmilan-instance_attributes-ip" name="ip" value="172.20.145.88"/>
          <nvpair id="fence2-ipmilan-instance_attributes-lanplus" name="lanplus" value="1"/>
          <nvpair id="fence2-ipmilan-instance_attributes-password" name="password" value="NJWQP62X"/>
          <nvpair id="fence2-ipmilan-instance_attributes-pcmk_host_list" name="pcmk_host_list" value="pg-rex42"/>
          <nvpair id="fence2-ipmilan-instance_attributes-username" name="username" value="Administrator"/>
        </instance_attributes>
        <operations>
          <op id="fence2-ipmilan-monitor-interval-3600s" interval="3600s" name="monitor" on-fail="restart" timeout="60s"/>
          <op id="fence2-ipmilan-start-interval-0s" interval="0s" name="start" on-fail="restart" timeout="60s"/>
          <op id="fence2-ipmilan-stop-interval-0s" interval="0s" name="stop" on-fail="ignore" timeout="60s"/>
        </operations>
      </primitive>
    </resources>
    <constraints>
      <rsc_location id="location-fence1-ipmilan-pg-rex41--INFINITY" node="pg-rex41" rsc="fence1-ipmilan" score="-INFINITY"/>
      <rsc_location id="location-fence2-ipmilan-pg-rex42--INFINITY" node="pg-rex42" rsc="fence2-ipmilan" score="-INFINITY"/>
      <rsc_location id="location-ipaddr-standby" rsc="ipaddr-standby">
        <rule id="location-ipaddr-standby-rule" score="200">
          <expression attribute="pgsql-status" id="location-ipaddr-standby-rule-expr" operation="eq" value="HS:sync"/>
        </rule>
      </rsc_location>
      <rsc_location id="location-ipaddr-standby-1" rsc="ipaddr-standby">
        <rule id="location-ipaddr-standby-1-rule" score="100">
          <expression attribute="pgsql-status" id="location-ipaddr-standby-1-rule-expr" operation="eq" value="PRI"/>
        </rule>
      </rsc_location>
      <rsc_location id="location-ipaddr-standby-2" rsc="ipaddr-standby">
        <rule id="location-ipaddr-standby-2-rule" score="-INFINITY">
          <expression attribute="pgsql-status" id="location-ipaddr-standby-2-rule-expr" operation="not_defined"/>
        </rule>
      </rsc_location>
      <rsc_location id="location-ipaddr-standby-3" rsc="ipaddr-standby">
        <rule boolean-op="and" id="location-ipaddr-standby-3-rule" score="-INFINITY">
          <expression attribute="pgsql-status" id="location-ipaddr-standby-3-rule-expr" operation="ne" value="HS:sync"/>
          <expression attribute="pgsql-status" id="location-ipaddr-standby-3-rule-expr-1" operation="ne" value="PRI"/>
        </rule>
      </rsc_location>
      <rsc_location id="location-pgsql-clone" rsc="pgsql-clone">
        <rule boolean-op="or" id="location-pgsql-clone-rule" score="-INFINITY">
          <expression attribute="ping-status" id="location-pgsql-clone-rule-expr" operation="not_defined"/>
          <expression attribute="ping-status" id="location-pgsql-clone-rule-expr-1" operation="lt" value="1"/>
        </rule>
      </rsc_location>
      <rsc_colocation id="colocation-pgsql-clone-ping-clone-INFINITY" rsc="pgsql-clone" score="INFINITY" with-rsc="ping-clone"/>
      <rsc_colocation id="colocation-primary-group-pgsql-clone-INFINITY" rsc="primary-group" rsc-role="Started" score="INFINITY" with-rsc="pgsql-clone" with-rsc-role="Master"/>
      <rsc_order first="ping-clone" first-action="start" id="order-ping-clone-pgsql-clone-mandatory" symmetrical="false" then="pgsql-clone" then-action="start"/>
      <rsc_order first="pgsql-clone" first-action="promote" id="order-pgsql-clone-primary-group-mandatory" symmetrical="false" then="primary-group" then-action="start"/>
      <rsc_order first="pgsql-clone" first-action="demote" id="order-pgsql-clone-primary-group-Optional" kind="Optional" symmetrical="false" then="primary-group" then-action="stop"/>
    </constraints>
    <rsc_defaults>
      <meta_attributes id="rsc_defaults-meta_attributes">
        <nvpair id="rsc_defaults-meta_attributes-resource-stickiness" name="resource-stickiness" value="200"/>
        <nvpair id="rsc_defaults-meta_attributes-migration-threshold" name="migration-threshold" value="1"/>
      </meta_attributes>
    </rsc_defaults>
  </configuration>
  <status/>
</cib>
